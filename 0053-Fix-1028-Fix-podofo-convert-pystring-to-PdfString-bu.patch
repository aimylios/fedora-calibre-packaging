From f8df2c374aee94814fabf4685120ae90872a8141 Mon Sep 17 00:00:00 2001
From: Kovid Goyal <kovid@kovidgoyal.net>
Date: Sat, 10 Aug 2019 19:34:11 +0530
Subject: [PATCH 53/71] Fix #1028 ( Fix podofo convert pystring to PdfString
 bug )

---
 src/calibre/utils/podofo/utils.cpp | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/calibre/utils/podofo/utils.cpp b/src/calibre/utils/podofo/utils.cpp
index 830fc5052e..ff2a9e6718 100644
--- a/src/calibre/utils/podofo/utils.cpp
+++ b/src/calibre/utils/podofo/utils.cpp
@@ -31,7 +31,8 @@ pdf::podofo_convert_pdfstring(const PdfString &s) {
 const PdfString
 pdf::podofo_convert_pystring(PyObject *val) {
 #if PY_MAJOR_VERSION > 2
-    return s(reinterpret_cast<const pdf_utf8*>(PyUnicode_AsUTF8(val)));
+    PdfString s(reinterpret_cast<const pdf_utf8*>(PyUnicode_AsUTF8(val)));
+    return s;
 #else
     PyObject *temp = PyUnicode_AsUTF8String(val);
     if (!temp) throw std::bad_alloc();
